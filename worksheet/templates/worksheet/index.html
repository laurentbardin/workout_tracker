{% extends 'worksheet/base.html' %}

{% block content %}

<table class="calendar">
    <caption>
        <h1>Workout calendar for {{ today | date:"F Y" }}</h1>
        {% if active_worksheets %}
        <div class="active-worksheets">
            <p>Some workouts are still in progress:</p>
            <ul>
                {% for worksheet in active_worksheets %}
                <li>{{ worksheet.date }}: <a href="{{ worksheet.get_absolute_url }}">{{ worksheet.workout }}</a></li>
                {% endfor %}
            </ul>
        </div>
        {% endif %}
    </caption>
    <thead>
        <tr>
            {% for day in days %}
            <th>{{ day }}</th>
            {% endfor %}
        </tr>
    </thead>
    <tbody>
        {% for week in calendar %}
        <tr>
            {% for date, data in week.items %}
            {% if date == today %}
            <td class="today">
            {% elif date.month != today.month %}
            <td class="other_month">
            {% else %}
            <td>
            {% endif %}
                <span>{{ date.day }}</span>
                {% if data.worksheet %}
                    <a href="{{ data.worksheet.get_absolute_url }}">{{ data.worksheet.workout }}</a>
                {% elif data.workout %}
                    {% if active_worksheets or date != today %}
                    {{ data.workout }}
                    {% else %}
                    <form action="{% url 'worksheet:create' %}" method="POST">
                        {% csrf_token %}
                        <button type="submit">{{ data.workout }}</button>
                    </form>
                    {% endif %}
                {% endif %}
            </td>
            {% endfor %}
        </tr>
        {% endfor %}
    </tbody>
</table>

{% endblock content %}
